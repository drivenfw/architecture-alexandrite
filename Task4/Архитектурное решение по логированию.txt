ПЛАНИРОВАНИЕ ЛОГИРОВАНИЯ

  Логи уровня INFO

    1. Пользователи (логируем время, id пользователя)
      - регистрация новых пользователей
      - вход в систему

    2. Заказы (логируем время, id пользователя, номер заказа)
      Онлайн-магазин:
        - пользователь завел заказ
        - пользователь загрузил файл с 3D-моделью
        - пользователь создал заказ

      CRM:
        - заказ подтвержден
        - заказ завершен

      MES:
        - система посчитала стоимость заказа
        - оператор взял заказ в работу
        - оператор выполнил заказ
        - оператор начал упаковывать заказ
        - заказ отправлен покупателю

  Также будут использоваться логи уровня FATAL, ERROR и DEBUG.


МОТИВАЦИЯ
  1. Добавление логирования в систему поможет повысить ее наблюдаемость
  2. Логи помогут быстрее реагировать на инциденты (может увеличить NPS, DAU/WAU/MAU)
  3. Логи помогут быстрее устанавливать причину проблем (может увеличить MTTR)
  4. Логи помогут быстрее отлаживать работу приложения при добавлении нового функционала (может увеличить TTM)

  Логи помогают при отладке разных компонентов приложения, а также позволяют собирать и анализировать данные о работе системы.
  Это помогает обнаружить ошибки. Ещё логи — это один из источников информации для мониторинга.

  В первую очередь следует настроить логирование и трейсинг для MES и онлайн магазина.
  Эти 2 наиболее нагруженные системы, с ними напрямую работают клиенты компании, сбои в этих системах сильно влияют на бизнес и
  ведут к недовольству клиентов.


ПРЕДЛАГАЕМОЕ РЕШЕНИЕ
  Требуется добавить логирование в приложениях:
    - онлайн магазин (Internet Shop + Shop API + Shop DB)
    - CRM (CRM + CRM API)
    - MES (MES + MES API + MES DB)

  Для работы с логами настроить ELK и добавить filebeat агенты на сервера для отправки логов.

  Политика безопасности:
    - маскировать чувствительные данные в логах
    - ограничить доступ к логам только авторизованным пользователям с соответствующей ролью

  C4: https://disk.yandex.ru/d/353nCg01OdlCuw

ХРАНЕНИЕ ЛОГОВ
  - Логи системы будут храниться в отдельном индексе Elasticsearch
  - Раздел сегмента в индексе будем держать в пределах 10–50 ГБ

СИСТЕМА АНАЛИЗА ЛОГОВ
  - настроить алерты для логов уровня FATAL и ERROR
  - настроить алерты на аномалии в логах (например, кол-во созданных заказов) -
    для этого нужно пособирать логи в течение определенного периода времени и за пороговые значения можно взять средние значения
